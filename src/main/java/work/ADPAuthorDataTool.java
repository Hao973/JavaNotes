package work;

import redis.clients.jedis.Jedis;

public class ADPAuthorDataTool {
    public static void main(String[] args) {
        String authorData = "正一坊琴行,6417659233336471625,-8882287995720656641,1,20201025|传递教育,6508233361071714322,-5249044568960126442,1,20201025|悦居英国,6133691084221886472,-3789493738864236082,1,20201025|娱见娱乐,6511072889809580089,8459656505636121205,1,20201025|21世纪军工评论,6676819109264932950,-4611957824942662139,1,20201025|这里是广西,6553840917047324677,6141917720510639362,1,20201025|万年腐青,6566850475147571327,-7356125175264626872,1,20201025|10分钟菜谱,6477737297365610559,6256802703993388285,1,20201025|乐活族生活指南,6250883099228811348,604874115814452942,1,20201025|炣燃科技,6565108333114994725,6028794909148532990,1,20201025|小贱讲历史,6426332479984414767,-5034764790248134560,1,20201025|生活常识小百科,6479213714012024877,-4075302303534969827,1,20201025|双鸭山发布,6417614664620224570,2293829870941649194,1,20201025|格格育儿,6417538320070782977,-2294217732764963489,1,20201025|陆驰汽车,6417601523903541323,-8458186747538577375,1,20201025|马克笔手绘,6608642649266499678,5198866006934111362,1,20201025|豫经南阳,5894525252343869443,7945891739185818281,1,20201025|华腾食品,6675662948654298375,7856198818373256417,1,20201025";
        String redisHost = "10.16.70.194";
        int redisPort = 6379;
        Jedis jedis = new Jedis(redisHost, redisPort);
        // auth
        String redisPassword = "ER8YKWPm";
        jedis.auth(redisPassword);
        System.out.println("connect redis[" + redisHost + ": " + redisHost + "] ok");
        for(String authorInfo: authorData.split("\\|")){
            String authorID = authorInfo.split(",")[1];
            String hashID = authorInfo.split(",")[2];
            System.out.println(authorID + ": " + hashID);
            String redisKey = "author_news_" + authorID;
            jedis.set(redisKey, hashID);
        }
        jedis.close();
    }
}
